2025-10-16 11:50:58 - [INFO] - Logger cho 'uitnlp_CafeBERT-training' ƒë√£ ƒë∆∞·ª£c kh·ªüi t·∫°o. File log: logs/uitnlp_CafeBERT-training/2025-10-16_11-50-58.log
2025-10-16 11:50:58 - [INFO] - Logger initialized for uitnlp/CafeBERT
2025-10-16 11:50:58 - [INFO] - ============================================================
2025-10-16 11:50:58 - [INFO] - üöÄ STARTING TRAINING SESSION
2025-10-16 11:50:58 - [INFO] - ============================================================
2025-10-16 11:50:58 - [INFO] - ROOT_DIR: /home/guest/Projects/CS221
2025-10-16 11:50:58 - [INFO] - DATA_DIR: /home/guest/Projects/CS221/data
2025-10-16 11:50:58 - [INFO] - TRAIN_FILE: /home/guest/Projects/CS221/data/vihallu-train.csv
2025-10-16 11:50:58 - [INFO] - TEST_FILE: /home/guest/Projects/CS221/data/vihallu-public-test.csv
2025-10-16 11:50:58 - [INFO] - SUBMISSION_DIR: /home/guest/Projects/CS221/submission
2025-10-16 11:50:58 - [INFO] - SUBMISSION_CSV: submit.csv
2025-10-16 11:50:58 - [INFO] - SUBMISSION_ZIP: submit.zip
2025-10-16 11:50:58 - [INFO] - MODEL_NAME: uitnlp/CafeBERT
2025-10-16 11:50:58 - [INFO] - MODEL_OUTPUT_DIR: /home/guest/Projects/CS221/models/CafeBERT-tuned
2025-10-16 11:50:58 - [INFO] - MAX_LENGTH: 512
2025-10-16 11:50:58 - [INFO] - RANDOM_STATE: 42
2025-10-16 11:50:58 - [INFO] - EPOCHS: 10
2025-10-16 11:50:58 - [INFO] - BATCH_SIZE: 4
2025-10-16 11:50:58 - [INFO] - GRADIENT_ACCUMULATION_STEPS: 4
2025-10-16 11:50:58 - [INFO] - LEARNING_RATE: 2e-05
2025-10-16 11:50:58 - [INFO] - WEIGHT_DECAY: 0.01
2025-10-16 11:50:58 - [INFO] - CLASSIFIER_DROPOUT: 0.02
2025-10-16 11:50:58 - [INFO] - EPSILON: 1e-08
2025-10-16 11:50:58 - [INFO] - PATIENCE_LIMIT: 2
2025-10-16 11:50:58 - [INFO] - TOTAL_STEP_SCALE: 0.1
2025-10-16 11:50:58 - [INFO] - LABEL_SMOOTHING: 0.05
2025-10-16 11:50:58 - [INFO] - VALIDATION_SPLIT_SIZE: 0.2
2025-10-16 11:50:58 - [INFO] - LABEL_MAP: {'intrinsic': 0, 'extrinsic': 1, 'no': 2}
2025-10-16 11:50:58 - [INFO] - ID2LABEL: {0: 'intrinsic', 1: 'extrinsic', 2: 'no'}
2025-10-16 11:50:58 - [INFO] - CLASS_WEIGHTS: [1.0393466963622866, 1.0114145354717525, 0.9531590413943355]
2025-10-16 11:50:58 - [INFO] - ============================================================
2025-10-16 11:51:01 - [INFO] - B·∫Øt ƒë·∫ßu pipeline hu·∫•n luy·ªán.
2025-10-16 11:51:01 - [INFO] - B∆∞·ªõc 1: Chu·∫©n b·ªã d·ªØ li·ªáu...
2025-10-16 11:51:01 - [INFO] - Chia d·ªØ li·ªáu: 5600 m·∫´u train, 1400 m·∫´u validation.
2025-10-16 11:51:01 - [INFO] - B∆∞·ªõc 2: T·∫£i model 'uitnlp/CafeBERT' v√† tokenizer...
2025-10-16 11:51:05 - [INFO] - B∆∞·ªõc 3: T·∫°o Dataset v√† DataLoader...
2025-10-16 11:51:05 - [INFO] - Gradient accumulation steps: 4 | Effective batch size: 16
2025-10-16 11:51:05 - [INFO] - B∆∞·ªõc 4: Thi·∫øt l·∫≠p m√¥i tr∆∞·ªùng hu·∫•n luy·ªán...
2025-10-16 11:51:06 - [INFO] - Scheduler will run for 3500 total steps (350 per epoch)
2025-10-16 11:51:06 - [INFO] - Warmup steps: 350
2025-10-16 11:51:06 - [INFO] - S·ª≠ d·ª•ng Class Weights cho h√†m loss.
2025-10-16 11:51:06 - [INFO] - --- Epoch 1/10 ---
2025-10-16 11:56:26 - [INFO] - Loss trung b√¨nh tr√™n t·∫≠p train: 1.0020
2025-10-16 11:56:26 - [INFO] - Current Learning Rate: 2.00e-05
2025-10-16 11:56:26 - [INFO] - B·∫Øt ƒë·∫ßu ƒë√°nh gi√° tr√™n t·∫≠p validation...
2025-10-16 11:56:51 - [INFO] - Validation Loss: 0.7892
2025-10-16 11:56:51 - [INFO] - Validation Accuracy: 0.6857
2025-10-16 11:56:51 - [INFO] - Validation Macro-F1: 0.6857
2025-10-16 11:56:51 - [INFO] - Classification Report tr√™n t·∫≠p validation:
              precision    recall  f1-score   support

   intrinsic     0.6253    0.6061    0.6155       490
   extrinsic     0.7717    0.6377    0.6983       461
          no     0.6783    0.8218    0.7432       449

    accuracy                         0.6857      1400
   macro avg     0.6917    0.6886    0.6857      1400
weighted avg     0.6905    0.6857    0.6837      1400

2025-10-16 11:56:51 - [INFO] - üéâ Macro-F1 c·∫£i thi·ªán. ƒêang l∆∞u model t·ªët nh·∫•t v√†o '/home/guest/Projects/CS221/models/CafeBERT-tuned'...
2025-10-16 11:56:53 - [INFO] - L∆∞u model th√†nh c√¥ng.
2025-10-16 11:56:53 - [INFO] - --- Epoch 2/10 ---
2025-10-16 12:02:19 - [INFO] - Loss trung b√¨nh tr√™n t·∫≠p train: 0.6475
2025-10-16 12:02:19 - [INFO] - Current Learning Rate: 1.94e-05
2025-10-16 12:02:19 - [INFO] - B·∫Øt ƒë·∫ßu ƒë√°nh gi√° tr√™n t·∫≠p validation...
2025-10-16 12:02:44 - [INFO] - Validation Loss: 0.7099
2025-10-16 12:02:44 - [INFO] - Validation Accuracy: 0.7414
2025-10-16 12:02:44 - [INFO] - Validation Macro-F1: 0.7399
2025-10-16 12:02:44 - [INFO] - Classification Report tr√™n t·∫≠p validation:
              precision    recall  f1-score   support

   intrinsic     0.7625    0.5898    0.6651       490
   extrinsic     0.6850    0.8113    0.7428       461
          no     0.7895    0.8352    0.8117       449

    accuracy                         0.7414      1400
   macro avg     0.7457    0.7454    0.7399      1400
weighted avg     0.7456    0.7414    0.7377      1400

2025-10-16 12:02:44 - [INFO] - üéâ Macro-F1 c·∫£i thi·ªán. ƒêang l∆∞u model t·ªët nh·∫•t v√†o '/home/guest/Projects/CS221/models/CafeBERT-tuned'...
2025-10-16 12:02:47 - [INFO] - L∆∞u model th√†nh c√¥ng.
2025-10-16 12:02:47 - [INFO] - --- Epoch 3/10 ---
2025-10-16 12:08:11 - [INFO] - Loss trung b√¨nh tr√™n t·∫≠p train: 0.4648
2025-10-16 12:08:11 - [INFO] - Current Learning Rate: 1.77e-05
2025-10-16 12:08:11 - [INFO] - B·∫Øt ƒë·∫ßu ƒë√°nh gi√° tr√™n t·∫≠p validation...
2025-10-16 12:08:36 - [INFO] - Validation Loss: 0.6754
2025-10-16 12:08:36 - [INFO] - Validation Accuracy: 0.7693
2025-10-16 12:08:36 - [INFO] - Validation Macro-F1: 0.7700
2025-10-16 12:08:36 - [INFO] - Classification Report tr√™n t·∫≠p validation:
              precision    recall  f1-score   support

   intrinsic     0.7538    0.7061    0.7292       490
   extrinsic     0.7390    0.7679    0.7532       461
          no     0.8160    0.8396    0.8277       449

    accuracy                         0.7693      1400
   macro avg     0.7696    0.7712    0.7700      1400
weighted avg     0.7689    0.7693    0.7687      1400

2025-10-16 12:08:36 - [INFO] - üéâ Macro-F1 c·∫£i thi·ªán. ƒêang l∆∞u model t·ªët nh·∫•t v√†o '/home/guest/Projects/CS221/models/CafeBERT-tuned'...
2025-10-16 12:08:38 - [INFO] - L∆∞u model th√†nh c√¥ng.
2025-10-16 12:08:38 - [INFO] - --- Epoch 4/10 ---
2025-10-16 12:14:00 - [INFO] - Loss trung b√¨nh tr√™n t·∫≠p train: 0.2974
2025-10-16 12:14:00 - [INFO] - Current Learning Rate: 1.50e-05
2025-10-16 12:14:00 - [INFO] - B·∫Øt ƒë·∫ßu ƒë√°nh gi√° tr√™n t·∫≠p validation...
2025-10-16 12:14:25 - [INFO] - Validation Loss: 1.0130
2025-10-16 12:14:25 - [INFO] - Validation Accuracy: 0.7407
2025-10-16 12:14:25 - [INFO] - Validation Macro-F1: 0.7415
2025-10-16 12:14:25 - [INFO] - Classification Report tr√™n t·∫≠p validation:
              precision    recall  f1-score   support

   intrinsic     0.7320    0.6633    0.6959       490
   extrinsic     0.6996    0.7679    0.7322       461
          no     0.7956    0.7973    0.7964       449

    accuracy                         0.7407      1400
   macro avg     0.7424    0.7428    0.7415      1400
weighted avg     0.7417    0.7407    0.7401      1400

2025-10-16 12:14:25 - [WARNING] - Macro-F1 kh√¥ng c·∫£i thi·ªán. Patience: 1/2
2025-10-16 12:14:25 - [INFO] - --- Epoch 5/10 ---
2025-10-16 12:19:47 - [INFO] - Loss trung b√¨nh tr√™n t·∫≠p train: 0.1732
2025-10-16 12:19:47 - [INFO] - Current Learning Rate: 1.17e-05
2025-10-16 12:19:47 - [INFO] - B·∫Øt ƒë·∫ßu ƒë√°nh gi√° tr√™n t·∫≠p validation...
2025-10-16 12:20:12 - [INFO] - Validation Loss: 1.3887
2025-10-16 12:20:12 - [INFO] - Validation Accuracy: 0.7564
2025-10-16 12:20:12 - [INFO] - Validation Macro-F1: 0.7564
2025-10-16 12:20:12 - [INFO] - Classification Report tr√™n t·∫≠p validation:
              precision    recall  f1-score   support

   intrinsic     0.7735    0.6551    0.7094       490
   extrinsic     0.7039    0.7787    0.7394       461
          no     0.7979    0.8441    0.8203       449

    accuracy                         0.7564      1400
   macro avg     0.7584    0.7593    0.7564      1400
weighted avg     0.7584    0.7564    0.7549      1400

2025-10-16 12:20:12 - [WARNING] - Macro-F1 kh√¥ng c·∫£i thi·ªán. Patience: 2/2
2025-10-16 12:20:12 - [INFO] - Early stopping! D·ª´ng hu·∫•n luy·ªán.
2025-10-16 12:20:12 - [INFO] - 
üèÅ Qu√° tr√¨nh hu·∫•n luy·ªán ho√†n t·∫•t.
2025-10-16 12:20:12 - [INFO] - Model t·ªët nh·∫•t v·ªõi Macro-F1 = 0.7700 ƒë√£ ƒë∆∞·ª£c l∆∞u t·∫°i '/home/guest/Projects/CS221/models/CafeBERT-tuned'
2025-10-16 12:22:14 - [INFO] - Distribution of each class:
  true_label  correct  incorrect
0  extrinsic      359        102
1  intrinsic      321        169
2         no      379         70
